{"version":3,"names":["useSafeContext","React","useCallback","useRef","InputFocusControllerContext","uniqueId","uuid","Node","constructor","value","next","id","LinkedList","size","node","head","lastNode","getLastNode","prevNode","Error","InputFocusController","children","refs","register","ref","current","push","unregister","remove","createOnSubmitEditing","console","log","currentRef","get","nextRef","focus","blur","useInputFocusControllerContext"],"sources":["InputFocusController.tsx"],"sourcesContent":["import { useSafeContext } from '@sirse-dev/safe-context';\r\nimport React, { PropsWithChildren, RefObject, useCallback, useRef } from 'react';\r\nimport { NativeMethods } from 'react-native';\r\n\r\nimport { InputFocusControllerContext } from './InputFocusControllerContext';\r\n\r\nlet uniqueId = 0;\r\nconst uuid = () => uniqueId++;\r\n\r\nclass Node<T> {\r\n    constructor(public value: T, public next: Node<T> | null, public id: number) {}\r\n}\r\n\r\nexport class LinkedList<T> {\r\n    private head: Node<T> | null = null;\r\n    public size = 0;\r\n\r\n    private getLastNode = () => {\r\n        if (this.size === 0) {\r\n            return null;\r\n        }\r\n\r\n        let node = this.head!;\r\n\r\n        while (node.next !== null) {\r\n            node = node.next;\r\n        }\r\n\r\n        return node;\r\n    };\r\n\r\n    public get = (id: number) => {\r\n        if (this.size === 0) {\r\n            return null;\r\n        }\r\n\r\n        let node = this.head!;\r\n\r\n        while (node.next && node.id !== id) {\r\n            node = node.next;\r\n        }\r\n\r\n        return node;\r\n    };\r\n\r\n    public push = (value: T): number => {\r\n        const id = uuid();\r\n        const node = new Node(value, null, id);\r\n\r\n        if (this.size === 0) {\r\n            this.head = node;\r\n        } else {\r\n            const lastNode = this.getLastNode()!;\r\n\r\n            lastNode.next = node;\r\n        }\r\n\r\n        this.size++;\r\n        return id;\r\n    };\r\n\r\n    public remove = (id: number) => {\r\n        if (this.size === 0) {\r\n            return;\r\n        }\r\n\r\n        let prevNode = this.head!,\r\n            node = this.head!;\r\n\r\n        while (node.id !== id) {\r\n            prevNode = node;\r\n            if (!node.next) {\r\n                throw new Error('hello');\r\n            }\r\n            node = node.next;\r\n        }\r\n\r\n        prevNode.next = node.next;\r\n\r\n        this.size--;\r\n    };\r\n}\r\n\r\nexport const InputFocusController = ({ children }: PropsWithChildren<{}>) => {\r\n    const refs = useRef(new LinkedList<RefObject<NativeMethods | undefined>>());\r\n\r\n    const register = useCallback((ref: RefObject<NativeMethods | undefined>) => {\r\n        const id = refs.current.push(ref);\r\n        return id;\r\n    }, []);\r\n\r\n    const unregister = useCallback((id: number) => {\r\n        refs.current.remove(id);\r\n    }, []);\r\n\r\n    const createOnSubmitEditing = useCallback(\r\n        (id: number) => {\r\n            return () => {\r\n                console.log(id);\r\n                const currentRef = refs.current.get(id);\r\n                const nextRef = currentRef?.next?.value;\r\n                if (nextRef) {\r\n                    nextRef.current?.focus();\r\n                } else {\r\n                    currentRef?.value.current?.blur();\r\n                }\r\n            };\r\n        },\r\n        [refs]\r\n    );\r\n    return (\r\n        <InputFocusControllerContext.Provider value={{ register, unregister, createOnSubmitEditing }}>\r\n            {children}\r\n        </InputFocusControllerContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useInputFocusControllerContext = () => useSafeContext(InputFocusControllerContext);\r\n"],"mappings":"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"}